{% extends "core/base.html" %}
{% load static %}

{% block title %}Super Admin ‚Äî Subscription{% endblock %}

{% block extra_head %}
<style>
  .page-wrap{
    max-width:780px;
    margin:0 auto;
    padding:24px 16px 56px;
  }

  .page-shell{
    background:transparent;
    border-radius: 18px;
    padding:0;
  }

  .hero{
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    gap:12px;
    flex-wrap:wrap;
    margin-bottom:14px;
    border:1px solid #dbe3ee;
    border-radius:18px;
    padding:20px 22px;
    background:
      radial-gradient(900px 260px at -20% -120%, #dbeafe 0%, transparent 58%),
      radial-gradient(700px 220px at 120% -110%, #dcfce7 0%, transparent 56%),
      #ffffff;
    box-shadow:0 12px 28px rgba(15,23,42,.08);
  }

  .topbar{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
    flex-wrap:wrap;
    margin-bottom:14px;
  }

  .backlink{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding:9px 14px;
    border-radius:999px;
    border:1px solid #d0dae7;
    background:linear-gradient(180deg,#ffffff,#f8fafc);
    color:#111827;
    text-decoration:none;
    font-weight:600;
    font-size:13px;
    box-shadow:0 10px 20px rgba(15,23,42,.05);
    transition:transform .08s ease, box-shadow .08s ease, background .08s ease;
  }
  .backlink:hover{
    background:#f3f4f6;
    transform:translateY(-1px);
    box-shadow:0 14px 26px rgba(15,23,42,.08);
    text-decoration:none;
  }
  .backlink:focus{
    outline:3px solid rgba(37,99,235,.18);
    outline-offset:2px;
  }

  .pill{
    font-size:12px;
    font-weight:800;
    color:#64748b;
    background:#ffffff;
    border:1px solid #dbe3ee;
    border-radius:999px;
    padding:8px 12px;
    box-shadow:0 10px 20px rgba(15,23,42,.05);
  }

  .card{
    background:#fff;
    border:1px solid #dbe3ee;
    border-radius:18px;
    box-shadow:0 10px 26px rgba(15,23,42,.06);
    overflow:hidden;
    position:relative;
  }

  .card::before{
    content:"";
    position:absolute;
    top:0;
    left:0;
    right:0;
    height:3px;
    background:linear-gradient(90deg,#2563eb,#0ea5e9,#22c55e);
    opacity:.75;
    z-index:3;
  }

  .card-head{
    padding:18px 18px 14px;
    border-bottom:1px solid #f1f5f9;
  }

  .title{
    margin:0;
    font-size:22px;
    font-weight:800;
    color:#0f172a;
    letter-spacing:-0.02em;
    display:flex;
    align-items:center;
    gap:10px;
    flex-wrap:wrap;
  }

  .subtitle{
    margin:6px 0 0;
    color:#64748b;
    font-weight:600;
    font-size:14px;
  }

  .owner-pill{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding:8px 12px;
    border-radius:999px;
    border:1px solid #dbe3ee;
    background:#f8fafc;
    font-weight:700;
    color:#0f172a;
    font-size:13px;
  }

  .body{
    padding:16px 18px 18px;
  }

  .form-grid{
    display:grid;
    gap:12px;
  }

  label{
    font-weight:700;
    color:#0f172a;
    font-size:13px;
    letter-spacing:.02em;
  }

  .field{
    width:100%;
    padding:11px 12px;
    border:1px solid #cbd5e1;
    border-radius:12px;
    font-weight:600;
    outline:none;
    background:#f8fafc;
    min-height:44px;
  }
  .field:focus{
    outline:3px solid rgba(37,99,235,.18);
    outline-offset:2px;
    border-color:#bfdbfe;
    background:#fff;
  }

  .hint{
    margin:-6px 0 0;
    color:#6b7280;
    font-weight:500;
    font-size:12px;
  }

  .btn-primary{
    width:100%;
    padding:12px 14px;
    border-radius:12px;
    border:1px solid #2563eb;
    background:#2563eb;
    color:#fff;
    font-weight:700;
    font-size:15px;
    box-shadow:0 12px 24px rgba(37,99,235,.20);
    transition:transform .08s ease, box-shadow .08s ease, background .08s ease;
    cursor:pointer;
  }
  .btn-primary:hover{
    background:#1d4ed8;
    border-color:#1d4ed8;
    transform:translateY(-1px);
    box-shadow:0 16px 28px rgba(37,99,235,.22);
  }
  .btn-primary:focus{
    outline:3px solid rgba(37,99,235,.22);
    outline-offset:2px;
  }

  .row{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:12px;
  }
  @media (max-width: 720px){
    .row{ grid-template-columns:1fr; }
  }

  .divider{
    height:1px;
    background:#f1f5f9;
    margin:14px 0 0;
    border:0;
  }

  .note{
    margin:12px 0 0;
    padding:12px 12px;
    border:1px solid #e5e7eb;
    border-radius:14px;
    background:#f8fafc;
    color:#334155;
    font-weight:500;
    font-size:13px;
    line-height:1.45;
  }

  .quick-days{
    margin-top:8px;
    display:flex;
    gap:8px;
    flex-wrap:wrap;
  }

  .day-chip{
    border:1px solid #dbeafe;
    background:#eff6ff;
    color:#1d4ed8;
    border-radius:999px;
    font-size:12px;
    font-weight:800;
    padding:4px 10px;
    cursor:pointer;
  }

  .summary{
    margin-top:10px;
    display:inline-flex;
    align-items:center;
    gap:6px;
    border:1px solid #e2e8f0;
    background:#f8fafc;
    color:#0f172a;
    border-radius:999px;
    padding:6px 10px;
    font-size:13px;
    font-weight:800;
  }

  @media (max-width: 720px){
    .page-wrap{ padding:18px 14px 48px; }
    .hero{ padding:16px; }
    .title{ font-size:20px; }
    .backlink{ width:100%; justify-content:center; }
  }
</style>

<script>
  // small UX: show custom_days only when plan=custom
  document.addEventListener("DOMContentLoaded", function(){
    const plan = document.querySelector('select[name="plan"]');
    const custom = document.querySelector('input[name="custom_days"]');
    const chips = document.querySelectorAll("[data-days]");
    const summary = document.getElementById("planSummary");
    if(!plan || !custom) return;

    function sync(){
      const isCustom = plan.value === "custom";
      custom.closest(".custom-wrap").style.display = isCustom ? "block" : "none";
      if (!summary) return;
      if (plan.value === "monthly") summary.textContent = "Monthly plan (30 days)";
      else if (plan.value === "yearly") summary.textContent = "Yearly plan (365 days)";
      else summary.textContent = "Custom plan (" + (custom.value || "0") + " days)";
    }
    plan.addEventListener("change", sync);
    custom.addEventListener("input", sync);
    chips.forEach((chip) => {
      chip.addEventListener("click", () => {
        custom.value = chip.getAttribute("data-days") || "";
        plan.value = "custom";
        sync();
      });
    });
    sync();
  });
</script>
{% endblock %}

{% block content %}
<div class="page-wrap">
  <div class="page-shell">

    <div class="hero">
      <div class="topbar">
        <a class="backlink" href="{% url 'superadmin_owner_detail' owner.id %}">‚Üê Back</a>
      </div>
      <span class="pill">Activate / Extend</span>
    </div>

    <div class="card">
      <div class="card-head">
        <div class="title">üí≥ Activate / Extend Subscription</div>
        <div class="subtitle">
          Owner:
          <span class="owner-pill">üë§ {{ owner.username }}</span>
        </div>
      </div>

      <div class="body">
        <form method="post" class="form-grid">
          {% csrf_token %}

          <div class="row">
            <div style="display:grid; gap:8px;">
              <label>Plan</label>
              <select name="plan" class="field">
                <option value="monthly">Monthly (30 days)</option>
                <option value="yearly">Yearly (365 days)</option>
                <option value="custom">Custom days</option>
              </select>
              <div class="hint">Choose monthly/yearly, or set a custom number of days.</div>
            </div>

            <div class="custom-wrap" style="display:grid; gap:8px;">
              <label>Custom Days</label>
              <input name="custom_days" class="field" placeholder="e.g., 45">
              <div class="hint">Only used when plan = Custom days.</div>
              <div class="quick-days">
                <button type="button" class="day-chip" data-days="15">15d</button>
                <button type="button" class="day-chip" data-days="30">30d</button>
                <button type="button" class="day-chip" data-days="45">45d</button>
                <button type="button" class="day-chip" data-days="90">90d</button>
                <button type="button" class="day-chip" data-days="365">365d</button>
              </div>
            </div>
          </div>

          <div class="summary">Selection: <span id="planSummary">Monthly plan (30 days)</span></div>

          <button class="btn-primary" type="submit">‚úÖ Save Subscription</button>

          <hr class="divider">

          <div class="note">
            <b>What this does:</b> sets the owner‚Äôs subscription expiry date forward.
            Staff automatically inherit the owner‚Äôs access.
          </div>
        </form>
      </div>
    </div>

  </div>
</div>
{% endblock %}
